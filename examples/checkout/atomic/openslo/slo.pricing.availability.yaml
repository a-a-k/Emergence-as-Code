apiVersion: openslo/v1
kind: SLO
metadata:
  name: slo.pricing.availability
spec:
  service: pricing
  indicator:
    metadata:
      name: sli.pricing.success
    spec:
      ratioMetric:
        counter: true
        good:
          metricSource:
            type: Prometheus
            metricSourceRef: prometheus-datasource
            spec:
              query: |
                sum(increase(http_requests_total{service="pricing",code=~"2..|3.."}[30d]))
        total:
          metricSource:
            type: Prometheus
            metricSourceRef: prometheus-datasource
            spec:
              query: |
                sum(increase(http_requests_total{service="pricing"}[30d]))
  timeWindow:
    - duration: 30d
      isRolling: true
  budgetingMethod: Occurrences
  objectives:
    - target: 0.999
